<!DOCTYPE html>
<html>
  <head>
    <title>DevFest AU Geo</title>
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

    <link type="text/css" href="scrollbar.css" rel="stylesheet">
    <link type="text/css" href="display.css" rel="stylesheet">
  </head>

  <body>
    <presentation>
      <slides>
        <slide>
          <section class="center">
            <img src="images/devfest.png" id="devfest-logo"/>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <h1>mmmmm Maps!</h1>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
          </slide>

        <slide>
          <section class="center">
            <header>About</header>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <img src="images/coffee3.jpg" width="400" class="fancy"/>
            <img src="images/coffee4.jpg" width="400" class="fancy to-show"/>
            <img src="images/coffee.jpg" width="400" class="fancy to-show"/>

            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <img src="images/googlemaps.png"/>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <h1>+</h1>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <img src="images/coffee1.jpg" class="fancy"/>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <h1>=</h1>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <h1>Awesome!</h1>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>


        <slide>
          <section class="center">
            <header>A Map!</header>
            <iframe src="maps/first-map.html" class="map-frame"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>The HTML</header>
<pre class="">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;...&lt;/head&gt;
  &lt;body&gt;
    &lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
  &lt;/body&gt;
&lt;/html&gt;
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>The CSS</header>
<pre class="">
&lt;style type=&quot;text/css&quot;&gt;
html, body {
  height: 100%;
  margin: 0;
}

#map {
  height: 100%;
}
&lt;/style&gt;
</pre>

            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>The JavaScript</header>
<pre class="">
&lt;script type=&quot;text/javascript&quot;
  src=&quot;http://maps.google.com/maps/api/js?sensor=false&quot;&gt;&lt;/script&gt;

&lt;script type=&quot;text/javascript&quot;&gt;
/**
 * Called on the intial page load.
 */
function init() {
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 14,
    center: new google.maps.LatLng(-33.866, 151.195),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  });
}

// Register an event listener to fire when the page finishes loading.
google.maps.event.addDomListener(window, 'load', init);
&lt;/script&gt;
</pre>

            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <header>A Map!</header>
            <iframe src="maps/first-map.html" class="map-frame"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
        <section class="center">
          <header>On the Mobile!</header>
            <div class="nexus">
              <iframe class="map-frame-mobile" src="maps/first-map-android.html"></iframe>
            </div>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>HTML5 to the rescue</header>
<pre>
function getUsersLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var pos = new google.maps.LatLng(position.coords.latitude,
        position.coords.longitude);
      map.panTo(pos);
    }, function() {
      // Can find the users location
    });
  }
}
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <header>Geolocation</header>
            <iframe class="map-frame" src="maps/map-geolocation.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <header>Markers</header>
            <iframe class="map-frame" src="maps/map-geolocation-with-marker.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>Markers</header>
<pre>
var marker = new google.maps.Marker();
</pre>
<pre>
navigator.geolocation.getCurrentPosition(function(position) {
  var pos = new google.maps.LatLng(position.coords.latitude,
    position.coords.longitude);
  map.panTo(pos);
  marker.setPosition(pos);
  marker.setMap(map);
}, function() {
  // Can find the users location
});
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <header>Custom Markers</header>
            <iframe class="map-frame" src="maps/map-geolocation-with-fancy-marker.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
          </slide>

        <slide>
          <section>
            <header>Marker Icons</header>
<pre>
var icon = new google.maps.MarkerImage('my-location.png',
  new google.maps.Size(14, 14), // Image Size
  new google.maps.Point(0, 0), // Origin
  new google.maps.Point(7, 7)); // Anchor

marker = new google.maps.Marker({
  icon: icon
});
</pre>
            <div class="center to-show"><img src="maps/my-location.png"</div>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
          </slide>

        <slide>
          <section class="center">
            <header>Overlays</header>
            <iframe class="map-frame" src="maps/map-with-gps-radius.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>Javascript</header>
<pre>
var circle = new google.maps.Circle({
  fillColor: '#00f',
  fillOpacity: 0.1,
  strokeColor: '#00f',
  strokeOpacity: 0.3,
  strokeWeight: 1
});
</pre>

<pre class="to-show">
circle.bindTo('center', marker, 'position');
</pre>

<pre class="to-show">
function getUsersLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function(position) {
      var pos = new google.maps.LatLng(position.coords.latitude,
        position.coords.longitude);
      map.panTo(pos);
      circle.setRadius(position.coords.accuracy);
      circle.setMap(map);
      ...
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>


        <slide>
          <section class="center">
            <header>Custom Controls</header>
            <iframe class="map-frame" src="maps/map-with-button.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>The CSS</header>
<pre>
.button {
  background: #fff;
  border: 1px solid #000;
  margin-top: 5px;
  -webkit-box-shadow:inset -1px -1px 1px #707070;
  font: 12px Arial, sans-serif;
  padding: 1px 4px;
  cursor: pointer;
}
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
          <header>The Javascript</header>
<pre>
var userLocation;
navigator.geolocation.watchPosition(setUsersPosition);
</pre>

<pre class="to-show">
function setUsersPosition(position) {
  var pos = new google.maps.LatLng(position.coords.latitude,
    position.coords.longitude);
  userLocation = pos;
  userLocationMarker.setPosition(pos);
  userLocationMarker.setMap(map);
}
</pre>

<pre class="to-show">
function addGotoUsersLocationButton() {
  var button = document.createElement('DIV');
  button.className = 'button';
  button.innerHTML = 'My Location';
  map.controls[google.maps.ControlPosition.TOP_RIGHT].push(button);
  google.maps.event.addDomListener(button, 'click', function() {
    if (usersLocation) {
      map.panTo(userLocation);
    }
  });
}
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <h1>Travellr</h1>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <h1>Welcome Back!</h1>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <header>Adding a shop</header>
            <iframe class="map-frame" src="maps/map-add-shop.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>Javascript</header>
<pre to="show">
function addAddNewShopButton() {
  var button = document.createElement('DIV');
  button.className = 'button';
  button.innerHTML = 'Add Shop';
  map.controls[google.maps.ControlPosition.TOP_RIGHT].push(button);

  google.maps.event.addDomListener(button, 'click', showNewShopForm);
}
</pre>
            <div class="to-show">
              <headerinline>Using jQuery</headerinline>
<pre>
function addNewShopButton() {
  var button = $('&lt;div class=&quot;button&quot;&gt;Add Shop&lt;/div&gt;');
  map.controls[google.maps.ControlPosition.TOP_RIGHT].push(button[0]);
  $(button).click(showNewShopForm);
}
</pre>
            </div>
          </section>
        </slide>

        <slide>
          <section>
          <header>Javascript</header>
<pre>
  var newShopMarker;
  var newShopInfoWindow;
</pre>
<pre>
function addMarkerAndInfoWindow() {
  var formHTML = ''&lt;div id=&quot;add-new-shop-form&quot;&gt;...&lt;/div&gt';
  newShopInfoWindow = new google.maps.InfoWindow({
    content: formHTML
  });

  newShopMarker = new google.maps.Marker();

  google.maps.event.addListener(map, 'click', function(mouseEvent) {
    newShopMarker.setPosition(mouseEvent.latLng);
  });
}
</pre>

            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
          <header>Javascript</header>
            <pre>
function showNewShopForm() {
  newShopMarker.setPosition(map.getCenter());
  newShopMarker.setMap(map);
  newShopInfoWindow.open(map, newShopMarker);
}
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <header>Reverse Geocoding</header>
            <iframe class="map-frame" src="maps/map-geocode.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>Javascript</header>
<pre>
function reverseGeocodeNewShopMarker() {
  var geocoder = new google.maps.Geocoder();
  var request = {latLng: newShopMarker.getPosition()};

  geocoder.geocode(request, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      var address = results[0].formatted_address;
      document.getElementById('new-shop-address').value = address;
    }
  });
}
</pre>
<pre class="to-show">
google.maps.event.addListener(map, 'click', function(e) {
  ...
  reverseGeocodeNewShopMarker();
});
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <header>Saving a shop</header>
            <iframe class="map-frame" src="maps/map-save.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>Javascript</header>
<pre>
var shopIcon = new google.maps.MarkerImage('coffee.png',
  new google.maps.Size(32, 37));
</pre>
<pre class="to-show">
function saveShop() {
  var position = newShopMarker.getPosition();

  // Gather form values and AJAX post to save the store

  newShopMarker.setMap(null);
  newShopInfoWindow.close();

  var marker = new google.maps.Marker({
    position: position,
    map: map,
    icon: shopIcon
  });
}
</pre>
<pre class="to-show">
google.maps.event.addListener(newShopInfoWindow, 'domready', function() {
  var saveButton = document.getElementById('new-shop-save');
  google.maps.event.addDomListener(saveButton, 'click', saveShop);
});
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
          <header>Finding Shops</header>
            <iframe class="map-frame" src="maps/map-search.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>Javascript</header>
<pre>
google.maps.event.addListener(map, 'bounds_changed', function() {
  findStores();
});
</pre>

<pre class="to-show">
var loadStoresTimeout;
</pre>

<pre class="to-show">
function findStores() {
  if (loadStoresTimeout) {
    window.clearTimeout(loadStoresTimeout);
  }

  loadStoresTimeout = window.setTimeout(function() {
    loadStoresInView();
  }, 150);
}
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>Javascript</header>
<pre>
function addStoreMarker(shop) {
  var position = new google.maps.LatLng(shop.lat, shop.lng);
  var marker = new google.maps.Marker({
    position: position,
    map: map,
    title: shop.name,
    icon: shopIcon
  });
  marker.key = shop.key;
  return marker;
}
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>Javascript</header>
<pre>
function addStores(shops) {
  var d = new Date();
  var added = '_' + d.getTime();
  for (var i = 0, shop; shop = shops[i]; i++) {
    if (shopMarkers[shop.key]) {
      shopMarkers[shop.key].added = added;
    } else {
      var marker = addStoreMarker(shop);
      marker.added = added;
      shopMarkers[shop.key] = marker;
    }
  }

  for (var key in shopMarkers) {
    if (shopMarkers[key].added != added) {
      shopMarkers[key].setMap(null);
      delete shopMarkers[key];
    }
  }
}
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
          <header>Directions</header>
            <iframe class="map-frame" src="maps/map-directions.html"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header>Javascript</header>
<pre>
var directionsService = new google.maps.DirectionsService();
var directionsRenderer = new google.maps.DirectionsRenderer({
  suppressMarkers: true,
  map: map
});
</pre>

<pre class="to-show">
function getDirectionsTo(shop) {
  var request = {
    origin: userLocationMarker.getPosition(),
    destination: shop.address,
    travelMode: google.maps.DirectionsTravelMode.WALKING
  };

  directionsService.route(request, function(result, status) {
    if (status == google.maps.DirectionsStatus.OK) {
      directionsRenderer.setDirections(result);
    }
  });
}
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <header>whereiscoffee.appspot.com</header>
            <iframe class="map-frame" src="http://whereiscoffee.appspot.com"></iframe>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section>
            <header class="center">Places API</header>
            Visit http://code.google.com/apis/maps/ documentation/places/ to find
            out more and to sign up for a developer preview!
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>


        <slide>
          <section>
          <header>Javascript</header>
<pre>
function getPlaces() {
  var data = {
    location: newShopMarker.getPosition().toUrlValue(),
    radius: 100
  };

  $.post('/places', data, function(data) {
    populatePlaces(data);
  });
}
</pre>

<pre class="to-show">
function populatePlaces(places) {
  if (places.status == 'OK') {
    for (var i = 0, place; place = places.results[i]; i++) {
      if (place.types.indexOf('establishment') != -1) {
        // Add result.name to a select box
      }
    }
  }
}
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
          </slide>

        <slide>
          <section>
            <header>Places API - Python</header>
<pre>
location = self.request.get('location')
radius = self.request.get('radius')

url_to_sign = ('/maps/api/place/search/json?location=%s&amp;'
  'radius=%s&amp;client=%s&amp;sensor=true') % (location, radius, CLIENT_ID)

decodedKey = base64.urlsafe_b64decode(PRIVATE_KEY)
signature = hmac.new(decodedKey, url_to_sign, hashlib.sha1)
encoded_signature = base64.urlsafe_b64encode(signature.digest())

places_url = ('http://maps.google.com/maps/api/place/search/json?location'
  '=%s&amp;radius=%s&amp;client=%s&amp;sensor=true&amp;'
  'signature=%s') % (location, radius, CLIENT_ID, encoded_signature)

self.response.out.write(urlfetch.fetch(places_url).content)
</pre>
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

        <slide>
          <section class="center">
            <devfestlogo><img src="images/devfest-small.png"/></devfestlogo>
            <googlelogo><img src="images/maps-logo.png"/></googlelogo>
          </section>
        </slide>

      </slides>
    </presentation>

    <script type="text/javascript" src="slide.js"></script>
  </body>
</html>
